#
# Usage:
#	Cmd_Mv(<SOURCE> <DESTINATION>)
#
FUNCTION(CMD_MV SOURCE DESTINATION)
	ABSOLUTE_PATH(SOURCE DESTINATION)
	IF(EXISTS ${SOURCE})
		IF((NOT EXISTS ${DESTINATION}) OR ((NOT IS_DIRECTORY ${SOURCE}) AND (NOT IS_DIRECTORY ${DESTINATION})))
			FILE(RENAME ${SOURCE} ${DESTINATION})
		ELSEIF((NOT IS_DIRECTORY ${SOURCE}) AND (IS_DIRECTORY ${DESTINATION}))
			GET_FILENAME_COMPONENT(SOURCE_NAME ${SOURCE} NAME)
			FILE(RENAME ${SOURCE} ${DESTINATION}/${SOURCE_NAME})
		ELSEIF(IS_DIRECTORY ${DESTINATION})
			FILE(GLOB SUB_SOURCES ${SOURCE}/*)
			FOREACH(SUB_SOURCE ${SUB_SOURCES})
				GET_FILENAME_COMPONENT(SUB_SOURCE_NAME ${SUB_SOURCE} NAME)
				CMD_MV(${SUB_SOURCE} ${DESTINATION}/${SUB_SOURCE_NAME})
			ENDFOREACH()
			CMD_RM(${SOURCE})
		ENDIF()
	ELSEIF(${SOURCE} MATCHES "[*|?]")
		FILE(GLOB_RECURSE SUB_SOURCES ${SOURCE})
		IF(SUB_SOURCES)
			GET_FILENAME_COMPONENT(SOURCE_PATH ${SOURCE} PATH)
			STRING(LENGTH ${SOURCE_PATH} SOURCE_PATH_LENGTH)
			FOREACH(SUB_SOURCE ${SUB_SOURCES})
				STRING(SUBSTRING ${SUB_SOURCE} ${SOURCE_PATH_LENGTH} -1 SUB_SOURCE_SUBSTRING)
				FILE(RENAME ${SUB_SOURCE} ${DESTINATION}${SUB_SOURCE_SUBSTRING})
			ENDFOREACH()
		ENDIF()
	ENDIF()
ENDFUNCTION()
